<html><head>
    

    <link rel="stylesheet" type="text/css" href="PrintablePage.css">

<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="GENERATOR" content="Microsoft FrontPage 6.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>Release Notes</title>
</head><body>

<h1>AIDAJNI</h1>
C++ to Java glue for AIDA

<h1>AIDAJNI 3.2.4 Release Notes (NOT YET RELEASED)</h1>
<p><font size="2">Release Notes Version: : 1.4 $.</font></p>
<p><font size="2">The most recent version of this file is available
<a href="http://java.freehep.org/aidajni/ReleaseNotes-3.2.4.html">here</a>.<br>
Release notes for all versions of AIDAJNI are available
<a href="http://java.freehep.org/aidajni/AllReleaseNotes.html">here</a>.</font></p>
<p>AIDAJNI is a C++ adapter of <a href="http://aida.freehep.org/">AIDA - 
Abstract Interfaces for Data Analysis</a> which connects to a Java 
implementation of AIDA, such as <a href="http://java.freehep.org/jaida">JAIDA</a>.</p>
<p>AIDAJNI allows C++ programmers to use any Java AIDA implementation. </p>
<p>It allows for instance <a href="http://geant4.cern.ch/geant4">Geant4</a>, written in 
C++, to create histograms and ntuples in Java and store them in .aida files, 
which can be analyzed using
<a href="http://jas.freehep.org/jas3/index.html">JAS3 - Java Analysis Studio</a>.</p>
<h2>Contents</h2>
<ul>
  <li><a href="#Compliance">AIDA Compliance</a></li>
  <li><a href="#Platforms">Supported Platforms</a></li>
  <li><a href="#Changes">Major changes in AIDAJNI 3.2.4</a></li>
  <li><a href="#Documentation">Documentation</a></li>
  <li><a href="#License">License</a></li>
  <li><a href="#Installation">Installing AIDJNI</a></li>
  <li><a href="#Compilation">Compiling AIDAJNI</a></li>
  <li><a href="#Building">Building an Application with AIDAJNI</a></li>
  <li><a href="#Running">Running an Application with AIDAJNI</a></li>
  <li><a href="#Geant4">Using AIDAJNI from Geant4</a></li>
  <li><a href="#Features">Features/Limitations of the Current Release</a></li>
  <li><a href="#BugReporting">Reporting Bugs</a></li>
  <li><a href="#Examples">Examples</a></li>
</ul>
<h2><a name="Compliance">AIDA Compliance</a></h2>
<p>This adapter connects AIDA-C++ to AIDA-JNI. It almost fully supports the AIDA 
standard. The C++ and Java side are both AIDA 3.2.1 compliant (for usage in Geant 4.6.x).</p>
<h2><a name="Platforms">Supported Platforms</a></h2>
<p>Binaries are available and supported for the following combinations of 
architectures and compilers:</p>
<ul>
  <li>Windows NT/2000/XP<ul>
    <li><b>WIN32-VC7</b>: Visual Studio .NET Professional 2003.<br>
    Microsoft (R) 32-bit C/C++ Optimizing Compiler Version 
    13.10.3077 for 80x86</li>
    <li><b>WIN32-g++</b>: gcc version 3.3.1 (cygming special)<br>
    Using a cygwin shell.</li>
  </ul>
  </li>
  <li>Linux Red Hat Linux 7.2 (Enigma) 2.4.20-30.7.legacysmp (2x1396MHz Intel)<ul>
    <li><b>Linux-g++2</b>: gcc version 2.95.3 20010315 (release)</li>
  </ul>
  </li>
  <li>RHEL WS 3 (Taroon Update 1)         2.4.21-15.0.4.ELsmp (2x1396MHz Intel)<ul>
    <li><b>Linux-g++</b>: gcc version 3.2.3 20030502 (Red Hat Linux 3.2.3-24)</li>
	<li><b>Linux-icc</b>: Intel(R) C++ Compiler for 32-bit applications, 
Version 8.0   Build 20031231Z Package ID: l_cc_pc_8.0.058</li>
	<li><b>Linuxamd64-g++</b> <i>(supported only)</i>: gcc version 3.4.2 
	20041017 (Red Hat 3.4.2-6.fc3)</li>
  </ul></li>
  <li>MacOS X 10.3<ul>
    <li><b>Darwin-g++</b>: gcc version 3.3 20030304 (Apple Computer, Inc. build 1666)</li>
  </ul>
  </li>
  <li>SUN Solaris<ul>
    <li><b>SUN-CC</b>: CC: Forte Developer 7 C++ 5.4 Patch 111715-13 2003/12/11</li>
  </ul>
  </li>
</ul>
<h2><a name="Changes">Major changes in AIDAJNI 3.2.4</a></h2>
<h3>Bug</h3>
<ul>
<li>[<a href='http://bugs.freehep.org/browse/AIDAJNI-46'>AIDAJNI-46</a>] - fit with initial parameters has missing argument in call.</li>
</ul>
        
<h3>Task</h3>
<ul>
<li>[<a href='http://bugs.freehep.org/browse/AIDAJNI-47'>AIDAJNI-47</a>] - Port code/infrastructure to AMD-64</li>
</ul>
<p><font size="2">For a full list of changes in AIDAJNI 3.2.4 see the
<a href="http://java.freehep.org/redirect?project=AIDAJNI&area=bugs&report=changelog">AIDAJNI
change log</a>.<br>
For a full list of changes in  AIDA 3.2.1 see the
<a href="http://aida.freehep.org/releaseNotes.thtml">AIDA change 
log</a>.</font></p>
<h2><a name="Documentation">Documentation</a></h2>
<p>These release notes list issues specific to the AIDAJNI implementation of AIDA. 
In general all of the AIDA documentation applies to AIDAJNI, in particular the 
following are useful:</p>
<ul>
  <li><a href="http://aida.freehep.org/doc/v3.2.1/UsersGuide.html">AIDA 
  3.2.1 Users' Guide</a></li>
  <li><a href="http://aida.freehep.org/doc/v3.2.1/api/index.html">AIDA 3.2.1 API 
  documentation</a></li>
</ul>
<h2><a name="License">License</a></h2>
<p>AIDAJNI is part of the <a href="http://java.freehep.org/">FreeHEP Java Library</a> 
an &quot;Open Source&quot; library distributed under the terms of the
<a href="http://www.gnu.org/copyleft/lesser.html">LGPL</a>. If you have 
questions about the licensing please send a mail to:
<a href="mailto:developers@freehep.org">developers@freehep.org</a>.</p>
<h2><a name="Installation">Installin</a>g AIDAJNI</h2>
<p>Download and install a Java AIDA Implementation which supports AIDA 3.2.1, for 
example <a href="http://java.freehep.org/jaida">JAIDA</a>.</p>

<p>Download AIDAJNI for one or more platforms. These distributions overlay on 
top of each other, adding support for different architectures. The distribution 
creates the following directory structure:</p>

<pre>AIDAJNI-version            containing license and release notes
AIDAJNI-version/bin        containing platform specific directories with setup scripts
AIDAJNI-version/examples   containing examples
AIDAJNI-version/include    containing all necessary include files
AIDAJNI-version/lib        containing platform specific directories with libraries
                           (shareable and static)</pre>
<h2><a name="Compilation">Compilation</a></h2>
<p>The current distributions do not contain source files.  </p>
<p>To (re-)build AIDAJNI for a 
particular platform you need to get AIDAJNI-3.2.4-src.zip or .tar.gz file from 
the <a href="ftp://ftp.slac.stanford.edu/software/freehep/AIDAJNI/v3.2.4/">ftp://ftp.slac.stanford.edu/software/freehep/AIDAJNI/v3.2.4/</a> directory. </p>
<p>Follow the instructions in README-src.html contained in that 
distribution.</p>
<h2><a name="Building">Building</a> an Application with AIDAJNI</h2>
<p>Set the environment variable AIDAJNI_HOME to your unpacked AIDAJNI 
distribution. Make sure JDK_HOME is set to your Java Development Kit (1.4 or 
better), and source the system specific aidajni-setup file (.sh/.csh fro Unix, 
.bat for Windows, .win32 for Cygwin).</p>
<p>Example for Linux-g++, using tcsh:</p>
<blockquote>
  <pre>setenv AIDAJNI_HOME /users/tom/AIDAJNI-3.2.4
setenv JDK_HOME /users/tom/j2sdk1.4.1
source /bin/Linux-g++/aidajni-setup.csh</pre>
</blockquote>
<p>Now you are able to execute the aida-config utility:</p>
<blockquote>
  <pre>aida-config --version	will display the version you installed.
aida-config --include 	will display the include options 
                        for your compiler.
aida-config --lib 	will display the library link options 
                        for your linker.</pre>
</blockquote>
<p>To compile (example for Linux-g++): </p>
<blockquote>
  <pre>g++ -c `aida-config --include` YourApplication.cc
g++ YourApplication.o `aida-config --lib`</pre>
</blockquote>
<h2><a name="Running">Running</a> an Application with AIDAJNI</h2>
<p>Once you have run the aidajni-setup script successfully you can just execute 
your application.</p>

<h2><a name="Geant4">Using AIDAJNI from Geant4</a></h2>

<p>For <b>Geant4 version 4.5.x</b> use AIDAJNI 3.0.4 and its Geant4 overlay 
product. See <a href="ReleaseNotes-3.0.4.html">ReleaseNotes</a> of version 
3.0.4.</p>

<p>For <b>Geant4 version 4.6.x</b> the fixes to the A01 example and the overlay 
are included in the Geant4 release. One only needs to install JAIDA and AIDAJNI 
as described above.</p>

<p><b>IMPORTANT</b>: Make sure you do <b>not</b> link in OPENGL libraries since they pre-load
libXt.so, which will make the JavaVM crash when it tries to open its first Window/Frame.
This does NOT apply to the Windows Operating System of course. This bug was
reported to Sun Microsystems as early as JDK 1.3.1, and has not been fixed for
JDK 1.5.  
Bugnumber <a href="http://developer.java.sun.com/developer/bugParade/bugs/4638291.html">4638291</a></p>

<h2><a name="Features">Features/Limitations of the Current Release</a></h2>
<p>The following limitations exist:</p>
<ul>
  <li>On MacOS X there are some complications running the GUI parts of AIDAJNI 
  (Plotter, ...). The problem is that non-bundled applications on MacOS X, such 
  as AIDAJNI, cannot by default interact with the user or open any GUI windows. 
  To overcome this problem there are a number of undocumented (Apple) calls one 
  can do. However it also turns out that one needs to also start Java in the 
  &quot;correct&quot; thread. This all is undocumented by Apple, so there is no easy 
  programmatic way out. Our solution is the following:<ul>
    <li>If you only use the non-GUI parts of AIDAJNI, there should be no 
    problems and you can just compile, link and run your program with AIDAJNI.</li>
    <li>If you use the GUI parts of AIDAJNI we run your C++ program from Java. 
    This makes sure that the Apple JavaVM will be initialized correctly, on the 
    right thread and as a GUI application. When your program calls AIDAJNI, we 
    will search (and find) the JavaVM which was already started and use that to 
    handle calls to JAIDA. To do so, you application should not be linked into 
    an executable but into a shared library with a statement similar to the 
    following:<br>
    <font face="Courier New" size="2"><br>
    g++ -dynamiclib -flatnamespace -o libYourApplicationName.jnilib /lib/Darwin-g++/runs.o 
    ...</font><br>
    <br>
    You then need to set up the DYLD_LIBRARY_PATH to point to this shared 
    library:<br>
    <br>
    <font face="Courier New" size="2">export DYLD_LIBRARY_PATH=/usr/home/duns/YourApplicationsDirectory:</font><br>
    <br>
    And can then start you application with the command:<br>
    <br>
    <font face="Courier New" size="2">java runs YourApplicationName<br>
    </font><i><br>
    runs.class implements the small java wrapper around your application.</i><br>
    <br>
    In future releases of MacOS X this problem may be fixed by apple and this 
    solution will not be needed anymore.<br>
    For more information see
    <a href="http://bugs.freehep.org/secure/ViewIssue.jspa?id=11386">AIDAJNI-28</a>.</li>
  </ul>
  </li>
  <li>On Linux RedHat 9 distribution a program using AIDAJNI will finish with a 
  crash, due to some threading problem in the Linux kernel. You need to set 
  LD_ASSUME_KERNEL 2.4.1 to avoid this crash, until the next kernel is 
  distributed. For more information see
  <a href="http://bugs.freehep.org/secure/ViewIssue.jspa?key=AIDAJNI-5">AIDAJNI-5</a> in our bug database.</li>
  <li>There may be memory leaks in some places, but we currently cannot run AIDAJNI through valgrind, since valgrind core dumps on running the Java 
  Virtual Machine.</li>
  <li>Many routines will return references to objects which are ONLY valid until 
  the next
  call to the same routine is made.</li>
  <li>CIxxx.cpp and CIxxx.h classes are currently available for experimental use 
  only. They allow a C++ implementation of an object (Histogram for instance) to 
  be passed to and handled by Java. This allows a C++ histogram 
  to be plotted by a Java plotter. Current concrete CI classes do <b>NOT</b> 
	include: <b>CIAnalysisFactory, CIDataPointSetFactory and CIHistogramFactory</b>. Only classes for which CI classes 
	exist can be passed from C++ to Java.</li>
  <li>ITree.ls() is not implemented because we would need an ostream connected to 
  an java.io.OutputStream.</li>
  <li>ITuple.fill on ITupleEntry is implemented but will not work.</li>
  <li>ITuple.getObject() will fail if the stored column is not an ITuple.</li>
  <li>ITree.listObjectNames() and ITree.listObjectTypes() return an empty list 
  in case of failure.</li>
  <li>The distribution kits contain some CVS directories and files, please 
  ignore.</li>
</ul>
<h2><a name="BugReporting">Reporting Bugs</a></h2>
<p>For discussion of features or problems related to AIDAJNI please use the
<a href="http://java.freehep.org/redirect?project=AIDAJNI&area=forum">AIDA forum</a>. To 
report bugs or request enhancements you can also use the
<a href="http://java.freehep.org/redirect?project=AIDAJNI&area=bugs&report=changelog">AIDAJNI bug database</a>.
</p>
<h2><a name="Examples">Examples</a></h2>
<p>The AIDJNI/examples directory contains AidaTest.cc which serves as  a small test as well as an example. 
The subdirectories g++, CC and VC contain build scripts to compile and link 
AidaTest.cc into an executable. JAIDA and AIDAJNI must have been set up before 
running the build script. </p>

<p>The standard AIDATest package in C++ is 
used to test the AIDAJNI adapter. Some minor tweaks are being made to the tests 
and the JAIDA implementation so that all of them will pass, but we believe the AIDAJNI does not 
have major errors in it.</p>



</body></html>